# 問題追蹤與解決

本目錄用於記錄開發和測試過程中遇到的問題，以及對應的解決方案。

---

## 核心原則

**遇到問題時，不要直接修改程式碼。**

正確的流程：
1. 建立問題記錄文件
2. 分析問題根因
3. 提出解決方案
4. 如需修改 spec，先更新 spec
5. 然後再修改程式碼
6. 測試驗證
7. 更新問題狀態

---

## 目錄結構

```
issues/
├── README.md              # 本文件
├── issue-001.md           # 問題 1
├── issue-002.md           # [已解決] 問題 2
└── issue-template.md      # 問題記錄範本
```

---

## 問題分類

### Bug (錯誤)
- 程式碼行為與預期不符
- 功能無法正常運作
- 錯誤處理不當

### Performance Issue (效能問題)
- 回應時間過長
- 資源使用過高
- 記憶體洩漏

### Security Issue (安全問題)
- 安全漏洞
- 認證/授權問題
- 資料洩露風險

### Design Issue (設計問題)
- Spec 定義不清楚
- 設計缺陷
- 架構問題

### Integration Issue (整合問題)
- 模組間整合失敗
- API 整合問題
- 第三方服務問題

---

## 問題優先級

### P0 - 緊急 (Critical)
- 系統無法運作
- 資料遺失風險
- 安全性重大漏洞
- **需要立即處理**

### P1 - 高 (High)
- 核心功能無法使用
- 影響多數用戶
- **需要盡快處理**

### P2 - 中 (Medium)
- 部分功能受影響
- 有替代方案
- **排入開發計劃**

### P3 - 低 (Low)
- 小問題
- 不影響主要功能
- **有時間再處理**

---

## 建立問題記錄

### 何時建立

**必須建立問題記錄的情況：**
- 測試發現 bug
- 整合測試失敗
- 效能不符合預期
- 發現安全問題
- Spec 與實作不一致且需要修改
- 設計缺陷需要討論

### 如何建立

1. 複製 `issue-template.md`
2. 重新命名為 `issue-XXX.md` (按順序編號)
3. 填寫所有必要資訊
4. **重要：** 完整記錄問題重現步驟
5. **重要：** 分析根本原因
6. **重要：** 提出解決方案
7. 如果需要修改 spec，在解決方案中說明

---

## 問題處理流程

### 1. 問題報告階段
- 建立問題文件
- 設定優先級
- 分配負責人

### 2. 分析階段
- 重現問題
- 找出根本原因
- 確認影響範圍

### 3. 解決方案階段
- 提出解決方案
- 評估影響（是否需要改 spec）
- 確認解決方案可行

### 4. 實作階段
- 更新 spec（如需要）
- 修改程式碼
- 更新測試

### 5. 驗證階段
- 執行測試
- 確認問題已解決
- 確認無副作用

### 6. 完成階段
- 標記問題為已解決
- 更新問題文件
- 記錄學習心得

---

## 問題狀態

### 🔴 Open (待處理)
問題已建立，等待處理

### 🟡 In Progress (處理中)
正在分析或解決問題

### 🟢 Resolved (已解決)
問題已解決且驗證通過

標記方式：在標題加上 `[已解決]`
```
# [已解決] Issue-001: 用戶登入失敗
```

### ⚫ Closed (已關閉)
問題不需要處理或無法重現

標記方式：在標題加上 `[已關閉]`

---

## Spec 同步規則

當問題需要修改 spec 時：

### 1. 先更新 Spec
- 在解決問題前，先更新相關的 spec 文件
- 確保 spec 反映正確的設計

### 2. 記錄變更
- 在問題文件中記錄 spec 的變更
- 在 spec 的更新記錄中註明原因

### 3. 同步程式碼
- 根據新的 spec 修改程式碼
- 確保一致性

### 4. 更新測試
- 根據新的 spec 更新測試
- 確保測試覆蓋新的需求

---

## 問題檢視

### 依優先級檢視

**P0 - 緊急問題：**
- [列出所有 P0 問題]

**P1 - 高優先級：**
- [列出所有 P1 問題]

### 依狀態檢視

**待處理：**
- [列出所有待處理問題]

**處理中：**
- [列出所有處理中問題]

---

## 常見問題模式

### 模式 1: 認證問題
**常見原因：**
- Token 過期處理不當
- 權限檢查邏輯錯誤
- Session 管理問題

**解決方向：**
- 檢查 token 驗證邏輯
- 確認權限檢查流程
- 測試各種認證情境

---

### 模式 2: 資料驗證問題
**常見原因：**
- 前後端驗證規則不一致
- 驗證邏輯遺漏
- 錯誤訊息不明確

**解決方向：**
- 統一驗證規則
- 補充遺漏的驗證
- 改善錯誤訊息

---

### 模式 3: 整合問題
**常見原因：**
- API 合約不一致
- 資料格式不符
- 並行修改衝突

**解決方向：**
- 確認 API spec
- 檢查資料格式
- 解決合併衝突

---

## 預防措施

### 開發階段
- [ ] 嚴格遵循 spec
- [ ] 寫完整的測試
- [ ] Code review
- [ ] 使用 TypeScript 類型檢查

### 測試階段
- [ ] 測試所有情境
- [ ] 測試 edge cases
- [ ] 測試錯誤處理
- [ ] 整合測試

### 部署階段
- [ ] Staging 環境測試
- [ ] 漸進式部署
- [ ] 監控和警報
- [ ] 回滾準備

---

## 學習與改進

### 定期回顧
- 每個 Phase 結束後回顧問題
- 找出常見模式
- 改進開發流程

### 知識累積
- 記錄解決方案
- 建立最佳實踐
- 分享學習心得

---

## 範本使用

複製 `issue-template.md` 並填寫：
```bash
cp issue-template.md issue-001.md
```

---

最後更新：[日期]
