# Log Issue Command

記錄開發或測試過程中遇到的問題。

**重要：遇到問題時，不要直接修改程式碼。先建立問題記錄。**

## 輸入

請告訴我：
1. **問題簡述**：一句話描述問題
2. **發現時機**：開發/測試/整合測試中發現
3. **相關 Task**：在執行哪個 task 時發現（如果有）
4. **問題類型**：Bug / Performance / Security / Design / Integration
5. **優先級**：P0 緊急 / P1 高 / P2 中 / P3 低

## 要求

### 1. 問題描述

- **簡述**：清楚說明問題是什麼
- **詳細說明**：完整描述問題情況
- **發現時機**：在哪個階段、哪個任務發現

### 2. 重現步驟

**必須包含：**
- 前置條件：需要什麼環境/資料
- 詳細步驟：如何重現問題（步驟越詳細越好）
- 實際結果：發生了什麼
- 預期結果：應該發生什麼
- 參考 Spec：這個預期結果來自哪個 spec

**如果有錯誤訊息：**
- 完整的錯誤訊息
- Stack trace
- 相關日誌

**如果可能：**
- 螢幕截圖
- 錄影

### 3. 影響評估

- **影響範圍**：哪些功能受影響
- **影響用戶**：哪些用戶會遇到
- **頻率**：每次/偶爾/特定條件
- **嚴重程度**：系統無法運作/功能受限/小問題
- **替代方案**：是否有 workaround

### 4. 根因分析

**我會協助你進行分析：**

#### 程式碼分析
- 找出相關的程式碼
- 分析問題所在
- 追蹤資料流

#### 確定根本原因
可能的原因類型：
- 程式碼邏輯錯誤
- Spec 定義不清楚
- 驗證規則遺漏
- 錯誤處理不當
- 設計缺陷
- 第三方服務問題
- 環境配置問題

### 5. 解決方案

**提供至少一個解決方案，包含：**

#### 方案概述
清楚說明如何解決

#### 詳細步驟
1. 需要做什麼
2. 修改哪些檔案
3. 改什麼內容

#### Spec 更新需求
- [ ] 需要更新 spec
  - 哪些 spec 文件
  - 為什麼需要更新
  - 要改什麼
- [ ] 不需要更新 spec

#### 程式碼變更
展示修改前後的程式碼對比

#### 測試計劃
- 需要新增什麼測試
- 需要修改什麼測試

#### 優缺點和風險評估

如果有多個方案，提供比較表格。

### 6. 預防措施

思考：
- 為什麼會發生這個問題
- 如何避免類似問題
- 需要改進什麼（開發流程/測試策略/文件規範）

## 輸出

生成 `issues/issue-XXX.md` 文件（按順序編號）。

文件必須包含：
- 完整的問題描述
- 可重現的步驟
- 深入的根因分析
- 具體的解決方案
- 預防措施

## 後續流程

建立問題記錄後：

1. **如果需要更新 Spec**
   - 先更新相關的 spec 文件
   - 確保 spec 正確反映設計

2. **修改程式碼**
   - 根據更新後的 spec 修改
   - 確保一致性

3. **更新測試**
   - 新增測試覆蓋這個問題
   - 確保問題不會再發生

4. **驗證**
   - 執行所有測試
   - 確認問題已解決
   - 確認無副作用

5. **更新問題狀態**
   - 標記為 🟡 In Progress（處理中）
   - 完成後標記為 🟢 Resolved（已解決）
   - 在標題加上 `[已解決]`

## 檢查清單

- [ ] 問題描述清楚
- [ ] 重現步驟完整
- [ ] 根因分析深入
- [ ] 解決方案可行
- [ ] 考慮了 spec 同步
- [ ] 定義了測試計劃
- [ ] 提出了預防措施

完成後告訴我：
- Issue 編號
- 優先級
- 建議的解決方案
- 是否需要更新 spec
- 預估修復時間
