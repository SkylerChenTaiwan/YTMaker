# Sync Specs Command

檢查技術規格 (specs) 與實際程式碼是否同步。

**核心原則：Spec 必須 100% 反映程式碼的實際狀態。**

## 檢查項目

### 1. API 端點檢查

**檢查：** `tech-specs/backend-spec.md` 中定義的 API

對每個 API 端點：
- [ ] Spec 中有定義
- [ ] 實際程式碼中有實作
- [ ] 請求格式一致
- [ ] 回應格式一致
- [ ] HTTP 狀態碼一致
- [ ] 驗證規則一致
- [ ] 錯誤處理一致

**輸出：**
- 列出 Spec 有但程式碼沒有的 API
- 列出程式碼有但 Spec 沒有的 API
- 列出定義不一致的 API

---

### 2. 資料庫 Schema 檢查

**檢查：** `tech-specs/backend-spec.md` 中的資料庫設計

對每個資料表：
- [ ] Spec 中有定義
- [ ] 實際資料庫中有此表
- [ ] 欄位名稱一致
- [ ] 欄位類型一致
- [ ] 限制條件一致（NOT NULL, UNIQUE, etc.）
- [ ] 索引定義一致
- [ ] 關聯關係一致

**輸出：**
- 列出不一致的表格
- 列出缺少的欄位
- 列出多餘的欄位
- 列出類型不符的欄位

---

### 3. 前端元件檢查

**檢查：** `tech-specs/frontend-spec.md` 中定義的元件

對每個元件：
- [ ] Spec 中有定義
- [ ] 實際有實作
- [ ] Props 定義一致
- [ ] 功能描述一致

**輸出：**
- 列出缺少的元件
- 列出多餘的元件
- 列出定義不一致的元件

---

### 4. 頁面路由檢查

**檢查：** `product-design/pages.md` 與實際路由

對每個頁面：
- [ ] Pages.md 中有定義
- [ ] 實際有實作
- [ ] 路由路徑一致
- [ ] 權限要求一致
- [ ] 頁面功能一致

**輸出：**
- 列出缺少的頁面
- 列出多餘的頁面
- 列出定義不一致的頁面

---

### 5. 業務邏輯檢查

**檢查：** Service 層與 Spec 定義

對每個 Service：
- [ ] Spec 中有定義
- [ ] 方法簽名一致
- [ ] 業務邏輯符合描述
- [ ] 錯誤處理符合 Spec

**輸出：**
- 列出不一致的 Service

---

### 6. 驗證規則檢查

**檢查：** 驗證規則是否與 Spec 一致

- [ ] 前端驗證規則
- [ ] 後端驗證規則
- [ ] 前後端驗證一致

**輸出：**
- 列出不一致的驗證規則

---

## 檢查方法

### 自動檢查（優先）
如果可能，我會：
1. 讀取 spec 文件
2. 掃描實際程式碼
3. 比對差異
4. 生成報告

### 手動檢查
如果無法自動檢查，我會：
1. 引導你提供必要資訊
2. 進行人工比對
3. 記錄發現的問題

---

## 輸出報告

### 報告格式

```markdown
# Spec 同步檢查報告

**檢查日期：** [日期]
**檢查範圍：** [全部 / 後端 / 前端]

## 總結

- ✅ 完全同步的項目：X 個
- ⚠️ 發現不一致：Y 個
- ❌ 嚴重不一致：Z 個

## 詳細結果

### API 端點

#### ✅ 同步
- POST /api/v1/auth/login
- GET /api/v1/users/:id

#### ⚠️ 不一致
1. **POST /api/v1/auth/register**
   - Spec: 回傳 user 物件
   - 實際: 回傳 user 和 token
   - **建議：** 更新 Spec 反映實際回傳

2. **GET /api/v1/posts**
   - Spec: 未定義分頁參數
   - 實際: 支援 page, limit 參數
   - **建議：** 更新 Spec 加入分頁定義

#### ❌ 嚴重問題
1. **DELETE /api/v1/users/:id**
   - Spec: 有定義此 API
   - 實際: 未實作
   - **建議：** 實作此 API 或從 Spec 移除

### 資料庫

[類似格式...]

### 前端元件

[類似格式...]

## 建議行動

### 高優先級（必須處理）
1. [問題 1]
2. [問題 2]

### 中優先級（應該處理）
1. [問題 1]
2. [問題 2]

### 低優先級（可以延後）
1. [問題 1]
2. [問題 2]
```

---

## 處理不一致

發現不一致時，判斷：

### 情況 1: Spec 過時
**現象：** 程式碼已更新，但 Spec 未更新

**處理：**
1. 更新 Spec 反映實際狀態
2. 在 Spec 的更新記錄中註明
3. 確認更新後的 Spec 合理

### 情況 2: 程式碼未完成
**現象：** Spec 有定義，但程式碼未實作

**處理：**
1. 如果是 bug，建立 issue
2. 如果是未完成功能，建立 task
3. 或者從 Spec 移除（如果不需要了）

### 情況 3: 未記錄的變更
**現象：** 程式碼有 Spec 沒定義的功能

**處理：**
1. 如果是必要功能，補充到 Spec
2. 如果是不必要的，移除程式碼
3. 如果不確定，討論後決定

---

## 使用時機

**建議在以下時機執行同步檢查：**
- 每個 Phase 完成後
- 準備整合測試前
- 發現問題但不確定原因時
- 定期檢查（例如每週）
- 新成員加入專案時

---

## 執行檢查

請告訴我要檢查的範圍：
- [ ] 全部檢查
- [ ] 只檢查後端（API + 資料庫）
- [ ] 只檢查前端（元件 + 頁面）
- [ ] 只檢查特定部分：[指定]

我會進行檢查並生成詳細報告。
